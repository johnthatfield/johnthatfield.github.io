[{"content":"\u003ch1 id=\"introduction\"\u003eIntroduction\u003c/h1\u003e\n\u003cp\u003eBattery Management Unit\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTalks to slave cell monitoring units (CMUs) over IsoSPI\u003c/li\u003e\n\u003cli\u003eFilters and monitors reported cell voltages and tempeatures\u003c/li\u003e\n\u003cli\u003eRuns cell balancing algorithm\u003c/li\u003e\n\u003cli\u003eInterface to charger to put BMU in charge state and take commands from charger about when to pre-charge\u003c/li\u003e\n\u003cli\u003eHas shutdown interface for Insulation Monitoring Device (IMD), precharge resistor thermal sensor (PDOC), connector interlocks, and BMU battery state. Detection for these interfaces.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eJoint project with Jarrod Fisher.\u003c/p\u003e\n\u003ch1 id=\"design-requirements\"\u003eDesign Requirements\u003c/h1\u003e\n\u003ch2 id=\"fsae-rules-2023\"\u003eFSAE Rules 2023\u003c/h2\u003e\n\u003ch3 id=\"bmu-ams-rules\"\u003eBMU (AMS) Rules\u003c/h3\u003e\n\u003cp\u003eAt QUT Motorsport we refer to the \u0026lsquo;Accumulator Management System\u0026rsquo; as it\u0026rsquo;s industry standard term Battery Management Unit (BMU).\u003c/p\u003e\n\u003cp\u003eSome of the relevant rules are shown below, however, most of them pertain to software on the BMU, with the two core requirements from this for the BMU being\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe BMU can communicate with the cell montoring units which monitor the cell voltages\u003c/li\u003e\n\u003cli\u003eThe BMU is able to trip the shutdown circuit using a relay when there is a fault condition in software\u003c/li\u003e\n\u003cli\u003eIt must turn on an indicator light when there is a fault condition. For the revision B of this board, this should be implemented in hardware as it\u0026rsquo;s ambigious if the rules specify that you can have software implementations of the dash LEDs.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/bmu/Rules_AMS.png\" alt=\"AMS FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch3 id=\"imd-rules\"\u003eIMD Rules\u003c/h3\u003e\n\u003cp\u003eThe Insulation Monitoring Device (IMD) is also present in the accumulator. It has a high side 12V status signal if the measurement is good. From this we can derive the requirements\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThere must be a relay present in the accumulator to trip the shutdown circuit in the event this OKhs is not high\u003c/li\u003e\n\u003cli\u003eIt must not use any programmable logic\u003c/li\u003e\n\u003cli\u003eIt must turn on an indicator light when there is a fault condition.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/bmu/Rules_IMD.png\" alt=\"IMD FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch3 id=\"shutdown-circuit\"\u003eShutdown Circuit\u003c/h3\u003e\n\u003cp\u003eThe output of the vehicles latched safety shutdown circuit must power the highside of the contactors. This means that if the vehicle loses power or any shutdown segment opens, then the contactors will open.\u003c/p\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/bmu/Rules_SHDNCircuit.png\" alt=\"IMD FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch3 id=\"voltage-separation\"\u003eVoltage Separation\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eThe GLV and the Tractive circuits must be galvanically isolated\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/tsal/FSAERuleVoltageSeparation.png\" alt=\"Voltage Separation FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch3 id=\"pcb-clearance\"\u003ePCB Clearance\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12.7mm clearance over uncoated surface, or 4mm clearance under conformal coating\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/tsal/GLVTSClearance.png\" alt=\"Clearance FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch2 id=\"ipc-design-requirements-for-ts-to-ts-clearances\"\u003eIPC Design Requirements for TS to TS clearances\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e3mm clearance over surface for non conformal coated 600V nets\u003c/li\u003e\n\u003cli\u003e1.105mm clearance over surface for conformal coated 600V nets\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"team-design-requirements\"\u003eTeam Design Requirements\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eSoftware detection of all shutdown circuits for relaying over telemetry and debugging.\u003c/li\u003e\n\u003cli\u003eIndividual control of all 3 contactors using lowside MOSFETs for ease of driving from MCU.\u003c/li\u003e\n\u003cli\u003eOne charger detection loop to detect when plugged into a charger\u003c/li\u003e\n\u003cli\u003eE-Fuse on 12V power input - under voltage, over voltage and over current limit\u003c/li\u003e\n\u003cli\u003eSD Card for logging of battery data and keeping state\u003c/li\u003e\n\u003cli\u003e2x IsoSPI interfaces to the cell monitoring unit allowing for a redundant entry point to the IsoSPI chain - L9963E\u003c/li\u003e\n\u003cli\u003eConnector to interface all signals to IMD. This should be the IMD\u0026rsquo;s only connection to GLV.\u003c/li\u003e\n\u003cli\u003eA connector to interface power and 2x CANbus to the Sendyne. This should be the Sendyne\u0026rsquo;s only connection to GLV.\u003c/li\u003e\n\u003cli\u003eUse Wurth solder in standoffs so there is no compression/bending load on the PCB when mounted in the accumulator\u003c/li\u003e\n\u003cli\u003eUSB C for debugging and programming\u003c/li\u003e\n\u003cli\u003eJTAG for debugging and programming\u003c/li\u003e\n\u003cli\u003e2x Indicator LEDs for status\u003c/li\u003e\n\u003cli\u003e2x CANbus interfaces, enabling one to be connected to the 1Mbaud vehicle bus, and the other to the Sendyne which only operates at 500Kbaud\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"rev-b-additional-requirements\"\u003eRev B Additional Requirements\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eLatching of IMD, PDOC and BMU shutdown segments until a reset button is pushed\u003c/li\u003e\n\u003cli\u003eCurrent limited highside outputs for Dash LEDs implemented with non-programmable circuitry\u003c/li\u003e\n\u003cli\u003eDetection and measurement of the highside contactor shutdown input status so BMU can measure if operating contactors is possible\u003c/li\u003e\n\u003cli\u003eDetection of auxiliary coils of the contactors for contactor state detection and fault measurement.\u003c/li\u003e\n\u003cli\u003eTwo charger detection loops, one for detection of plugged into charger and one for precharge start.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch1 id=\"design-solution---rev-a\"\u003eDesign Solution - Rev A\u003c/h1\u003e\n\u003cp\u003e\u003cimg src=\"/images/bmu/BMU_Cropped.jpg\" alt=\"BMU\" title=\"BMU\"\u003e\u003c/p\u003e\n\u003ch1 id=\"pcb-layout---rev-a\"\u003ePCB Layout - Rev A\u003c/h1\u003e\n\u003cp\u003eLayer view - Ground plane layers Mid Top and Mid Bottom hidden\n\u003cimg src=\"/images/bmu/BMULayerView.png\" alt=\"BMU\" title=\"BMU\"\u003e\u003c/p\u003e\n\u003ch1 id=\"schematics\"\u003eSchematics\u003c/h1\u003e\n\u003cp\u003eNot published.\u003c/p\u003e\n\u003ch1 id=\"assembly\"\u003eAssembly\u003c/h1\u003e\n\u003cp\u003eThe BMUs were hand placed and soldered in a vapour phase oven.\u003c/p\u003e\n\u003cp\u003eRails were placed on the long edge of the PCB in the event we wanted to pick and place these as there are components close to the board edge.\u003c/p\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/bmu/bmu_reflow.jpg\" alt=\"BMU Reflow\" /\u003e\r\n\u003c/div\u003e\r\n","description":null,"image":null,"permalink":"https://johnthatfield.github.io/projects/bmu/","title":"Battery Management Unit (BMU)"},{"content":"\u003ch2 id=\"coming-soon\"\u003eComing Soon\u003c/h2\u003e\n","description":null,"image":null,"permalink":"https://johnthatfield.github.io/projects/pcb-fitout/","title":"Battery PCB Fitout"},{"content":"\u003ch1 id=\"introduction\"\u003eIntroduction\u003c/h1\u003e\n\u003cp\u003eCell Monitoring Unit\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTalks to slave cell monitoring units (CMUs) over IsoSPI\u003c/li\u003e\n\u003cli\u003eFilters and monitors reported cell voltages and tempeatures\u003c/li\u003e\n\u003cli\u003eRuns cell balancing algorithm\u003c/li\u003e\n\u003cli\u003eInterface to charger to put BMU in charge state and take commands from charger about when to pre-charge\u003c/li\u003e\n\u003cli\u003eHas shutdown interface for Insulation Monitoring Device (IMD), precharge resistor thermal sensor (PDOC), connector interlocks, and BMU battery state. Detection for these interfaces.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eJoint project with Thomas Hulbert.\u003c/p\u003e\n\u003ch1 id=\"design-requirements\"\u003eDesign Requirements\u003c/h1\u003e\n\u003ch2 id=\"fsae-rules-2023\"\u003eFSAE Rules 2023\u003c/h2\u003e\n\u003ch3 id=\"cmu-ams-rules\"\u003eCMU (AMS) Rules\u003c/h3\u003e\n\u003cp\u003eAt QUT Motorsport we refer to the \u0026lsquo;Accumulator Management System\u0026rsquo; as a combination of the BMU (battery monitoring unit) and CMU (cell monitoring units)\u003c/p\u003e\n\u003cp\u003eThe relevant rules from below are\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe AMS system must have galvanic isolation at every segment to segment boundary - i.e. isolation transformers\u003c/li\u003e\n\u003cli\u003eWork in progress\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/bmu/Rules_AMS.png\" alt=\"AMS FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003c!-- ### Voltage Separation\r\n- The GLV and the Tractive circuits must be galvanically isolated \r\n\r\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/tsal/FSAERuleVoltageSeparation.png\" alt=\"Voltage Separation FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e --\u003e\r\n\u003c!-- ### PCB Clearance\r\n- 12.7mm clearance over uncoated surface, or 4mm clearance under conformal coating\r\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/tsal/GLVTSClearance.png\" alt=\"Clearance FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e --\u003e\r\n\u003ch2 id=\"ipc-design-requirements-for-ts-to-ts-clearances\"\u003eIPC Design Requirements for TS to TS clearances\u003c/h2\u003e\n\u003cp\u003eOn surface of uncoated PCB\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e0.6mm spacing between nets \u0026gt;=31V potential to each other\u003c/li\u003e\n\u003cli\u003e0.1mm spacing for nets \u0026lt;= 30V potential to each other\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"team-design-requirements\"\u003eTeam Design Requirements\u003c/h2\u003e\n\u003ch1 id=\"revision-b---qev-3-only\"\u003eRevision B - QEV-3 Only\u003c/h1\u003e\n\u003cp\u003eA long time solution of a \u0026lsquo;Revision A\u0026rsquo; BMU strategy, using a BMU chip, a microcontroller and canbus between each slave device was used. We had some systemic issues with this which caused the upgrade.\u003c/p\u003e\n\u003cp\u003eThe revision A of the CMU was designed to interface in the same position as the previous generation QEV-3 BMS system. It would feature only 10 out of 14 cells.\u003c/p\u003e\n\u003cp\u003eAssembly of this device is shown below. The pototypes were hand placed at uni and soldered in a vapour phase oven.\n\u003cimg src=\"/images/cmu/cmu_rev_b_placed.jpg\" alt=\"CMU Rev B Assembly\" title=\"CMU Rev B Assembly\"\u003e\u003c/p\u003e\n\u003c!-- \r\nTesting of the Revision B CMUs. Two CMUs, one connected to a battery, one connected to a battery emulator board, \r\n\r\n![CMU Rev B Testing](/images/cmu/cmu_rev_b_testing.jpg \"CMU Rev B Testing\") --\u003e\r\n\u003cp\u003eAn implementation error with unused voltage taps was found - a fix was prototyped on the PCB as shown in the photo below.\n\u003cimg src=\"/images/cmu/cmu_rev_b.jpg\" alt=\"CMU Rev B\" title=\"CMU Rev B\"\u003e\u003c/p\u003e\n\u003ch1 id=\"revision-c\"\u003eRevision C\u003c/h1\u003e\n\u003cp\u003eIt was decided that the same CMU architecture should be used for the new vehicle - QEV-4. All 14 cells are required for QEV-4, so a 14 cell CMU should be designed and un-used cells tied together as per the datasheet.\u003c/p\u003e\n\u003cp\u003eBelow shown is the full implementation of the L9963E cell monitoring unit. It was designed around a small, double sided component load form factor, enabling it to fit atop of the small QEV-4 battery assembly.\u003c/p\u003e\n\u003cp\u003eA board to board connector was chosne, enabling it to either sit atop of a carrier PCB, or, connected with a custom flat flex cable.\u003c/p\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/cmu/CMU_Altium.png\" alt=\"CMU Altium\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch2 id=\"prototype-assembly\"\u003ePrototype Assembly\u003c/h2\u003e\n\u003cp\u003ePrototypes were assembled by hand and reflowed in a vapour phase oven.\u003c/p\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/cmu/cmu_rev_c_hand_assembly_camera2.jpg\" alt=\"CMU Altium\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch2 id=\"prototype-testing\"\u003ePrototype testing\u003c/h2\u003e\n\u003cp\u003eThe initial prototypes were then thoroughly tested using a breakout board to validate cell voltage readings and temperature analog inputs.\u003c/p\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/cmu/CMU_rev_c_test_assembly.png\" alt=\"CMU Rev C Test Assembly\" style=\"max-width: 600px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch2 id=\"qev-3-adaptor\"\u003eQEV-3 Adaptor\u003c/h2\u003e\n\u003cp\u003eThe adaptor for the previous generation car shown below connects the 10 cells, tying the remaining 4 cells together. It also has a temperature multiplexer to enable the CMU to read more tempearture cells for the larger battery assembly.\u003c/p\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/cmu/cmu_qev3_carrier.jpg\" alt=\"CMU Carrier QEV-3\" style=\"max-width: 800px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch2 id=\"pick-and-place-assembly\"\u003ePick and place assembly\u003c/h2\u003e\n\u003cp\u003eWe then worked with our pick and place sponsor, Taylormade Electronics, to pick and place enough CMU\u0026rsquo;s for QEV-3, QEV-4 and several spares. Working with Cameron from Taylormade Electronics has been an invaluable experience. It has enabled my understanding of the full design and assembly lifecycle, seeing first hand impacts of design decisions and changes on ease of assembly and reliability.\u003c/p\u003e\n\u003ch3 id=\"solder-paste-application\"\u003eSolder Paste Application\u003c/h3\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/cmu/cmu_paste.jpg\" alt=\"CMU Solder Paste Application\" style=\"max-width: 600px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch3 id=\"pick-and-place-setup\"\u003ePick and Place Setup\u003c/h3\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/cmu/cmu_pick_place_setup.jpg\" alt=\"CMU Pick and Place Setup\" /\u003e\r\n\u003c/div\u003e\r\n\u003ch3 id=\"assembled-cmus\"\u003eAssembled CMUs\u003c/h3\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\r\n\u003cimg src=\"/images/cmu/cmu_assembled.jpg\" alt=\"CMU Assembled\" style=\"max-width: 600px;\"/\u003e\r\n\u003c/div\u003e\r\n\u003ch1 id=\"schematics\"\u003eSchematics\u003c/h1\u003e\n\u003cp\u003eNot published. Please contact me for more information.\u003c/p\u003e\n","description":null,"image":null,"permalink":"https://johnthatfield.github.io/projects/cmu/","title":"Cell Monitoring Unit (CMU)"},{"content":"\u003ch2 id=\"coming-soon\"\u003eComing Soon\u003c/h2\u003e\n","description":null,"image":null,"permalink":"https://johnthatfield.github.io/projects/coffeemate/","title":"CoffeeMate Coffee Ecosystem"},{"content":"\u003ch1 id=\"introduction\"\u003eIntroduction\u003c/h1\u003e\n\u003cp\u003eFSAE vehicles, such as the QUT Motorsport vehicle, use four motors, one in each motor hub. This enables better delivery of torque and torque vectoring. As a result, these already small vehicles now have 4 relatively low powered motors. There are some existing solutions used by teams, such as the Bucher 60kW dual control unit, the Sevcon HVLP 20, and the VESC 100/250. However, these drives are made for auxiliary pumps and fans in larger buses and tractors, not meeting the packaging or performance requirements, or in the case of the VESC, designed for a skateboard, and so lacks the isolated safety requirements.\u003c/p\u003e\n\u003cp\u003eThe goal of this project was to design a robust, power-dense motor control solution that can fit into small vehicle spaces. The solution should minimise unnecessary complexity, focusing on delivering working and validated hardware\u003c/p\u003e\n\u003ch1 id=\"initial-design\"\u003eInitial Design\u003c/h1\u003e\n\u003cp\u003eRefer to thesis\u003c/p\u003e\n\u003ch1 id=\"solution\"\u003eSolution\u003c/h1\u003e\n\u003cp\u003eThe final device assembly is shown below, with control board on top, interface breakout, gate drives and power PCB on the bottom. Aluminum section has been used as a heatsink for initial testing.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/inverter/inverter.jpg\" alt=\"Assembled Inverter with Dummy Heatsink\" title=\"Inverter Assembly\"\u003e\u003c/p\u003e\n\u003ch1 id=\"low-voltage-600v-testing\"\u003eLow Voltage (600V) Testing\u003c/h1\u003e\n\u003cp\u003eThe goal was to perform double pulse testing to validate\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTurn on and turn off characteristics. Tuning of the on/off gate resistors on the drivers\u003c/li\u003e\n\u003cli\u003eTurn on and turn off delays in digital and analog systems\u003c/li\u003e\n\u003cli\u003eDeadzone calibration\u003c/li\u003e\n\u003cli\u003ePhase current shunt calibration\u003c/li\u003e\n\u003cli\u003eDelay in delta sigma modulator phase current from real current\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"test-setup\"\u003eTest Setup\u003c/h2\u003e\n\u003cp\u003eTesting at hazardous voltages, an isolation barrier between the test device and test interfaces was important. A basic enclosure was used as a physical barrier. An emergency stop was present to turn off the supply and connect a dicharge resistor across the capacitors.\n\u003cimg src=\"/images/inverter/complete_test_setup.jpg\" alt=\"Test Setup\" title=\"Test Setup\"\u003e\u003c/p\u003e\n\u003ch2 id=\"scope-connections\"\u003eScope Connections\u003c/h2\u003e\n\u003cp\u003eThe below shows the test setup.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe co-located control board during testing enables the MMCX +/- 50V probe to connect to the gate MMCX connector.\u003c/li\u003e\n\u003cli\u003eVDS 0.200\u0026quot; probe connection connected to pre-made lead.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/images/inverter/isovu_scope.jpg\" alt=\"Iso Probe Setup\" title=\"Iso Probe Setup\"\u003e\u003c/p\u003e\n\u003cp\u003eA close up of the connection shows the MMCX connector, as well as an additional differential probe used to measure the delta sigma modulator output.\n\u003cimg src=\"/images/inverter/measurement_close.jpg\" alt=\"Scope Close Up\" title=\"Scope Close Up\"\u003e\u003c/p\u003e\n","description":null,"image":null,"permalink":"https://johnthatfield.github.io/projects/inverter/","title":"SiC Inverter - Honours Thesis - QUT Motorsport"},{"content":"\u003ch1 id=\"introduction\"\u003eIntroduction\u003c/h1\u003e\n\u003cp\u003eThe tractive system active light (TSAL) in FSAE requires a flashing red light on top of the vehicle when the bus voltage is greater than 60V. When the voltage is below zero the light should be solid green indicating a safe state.\u003c/p\u003e\n\u003cp\u003eThe TSAL must be visible in daylight from a distance, meaning fairly high powered LEDs are required. The team has an LED board designed for the top of the vehicle which requires 600mA.\u003c/p\u003e\n\u003ch2 id=\"location-in-vehicle\"\u003eLocation In Vehicle\u003c/h2\u003e\n\u003cp\u003eAn important design factor. Traditionally QUT Motorsport placed their TSAL control board in the battery assembly on the vehicle side of the DC contactors. However, with the battery pack removed there is still a large capacitance in the vehicle at the motor controllers that could remain live for 10+ minutes if the discharge system fails. For this reason, the decision was made to place the TSAL control in the vehicle junction box, meaning the TSAL will show accurate tractive system voltage stage even with the battery pack removed.\u003c/p\u003e\n\u003ch1 id=\"design-requirements\"\u003eDesign Requirements\u003c/h1\u003e\n\u003ch2 id=\"fsae-rules-2023\"\u003eFSAE Rules 2023\u003c/h2\u003e\n\u003ch3 id=\"tsal-rules\"\u003eTSAL Rules\u003c/h3\u003e\n\u003cp\u003eAnalysis of relevant rules for TSAL Control circuitry\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEV.6.9.1a - TSAL PCB must be located on the vehicle side of the accumulator, as it must always function when GLV system is energised. The GLV system is defined without the accumulator.\u003c/li\u003e\n\u003cli\u003eEV.6.9.1b - Logic/analog circuitry must be used. No programmable microcontrollers/logic.\u003c/li\u003e\n\u003cli\u003eEV.6.9.1c - only contain TSAL circuitry. i.e. the same threshold trigger cannot be used to trigger the voltage indicator in the accumulator for example.\u003c/li\u003e\n\u003cli\u003eEV.6.9.3 - Output a flashing red LED signal (2-5 Hz) when the the voltage of the DC rails in the vehicle exceeds 60V\u003c/li\u003e\n\u003cli\u003eEV.6.9.4 - Output a solid green LED signal when the voltage of the DC rails in the vehicle is below 60V\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- ![TSAL FSAE Ruleset 2023](/images/tsal/TSALRules.png \"TSAL FSAE Ruleset 2023\") --\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\n\u003cimg src=\"/images/tsal/TSALRules.png\" alt=\"TSAL FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\n\u003c/div\u003e\n\u003ch3 id=\"voltage-separation\"\u003eVoltage Separation\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eThe GLV and the Tractive circuits must be galvanically isolated\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\n\u003cimg src=\"/images/tsal/FSAERuleVoltageSeparation.png\" alt=\"Voltage Separation FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\n\u003c/div\u003e\n\u003ch3 id=\"pcb-clearance\"\u003ePCB Clearance\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12.7mm clearance over uncoated surface, or 4mm clearance under conformal coating\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv style=\"text-align: center;\"\u003e\n\u003cimg src=\"/images/tsal/GLVTSClearance.png\" alt=\"Clearance FSAE Ruleset 2023\" style=\"max-width: 800px;\"/\u003e\n\u003c/div\u003e\n\u003ch2 id=\"ipc-design-requirements-for-ts-to-ts-clearances\"\u003eIPC Design Requirements for TS to TS clearances\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e3mm clearance over surface for non conformal coated 600V nets\u003c/li\u003e\n\u003cli\u003e1.105mm clearance over surface for conformal coated 600V nets\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"team-design-requirements\"\u003eTeam Design Requirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eThe LED assembly on the roll hoop should only contain the LEDs. All drivers and control circuitry should be present on the TSAL Control board. This keeps the housing small and minimises heat and complexity in the roll hoop housing\u003c/li\u003e\n\u003cli\u003eThe LED drivers shall run on a voltage between 11V and 14.6V as the 12V LiFePO4 battery in the vehicle will power the board.\u003c/li\u003e\n\u003cli\u003eSwitch mode LED drivers should be used for their high efficiency compared to linear drivers - important with the varying GLV voltage.\u003c/li\u003e\n\u003cli\u003eRed and green status indicators on PCB to display red/green status without external LED board connected\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"design-solution\"\u003eDesign Solution\u003c/h1\u003e\n\u003cp\u003e\u003cimg src=\"/images/tsal/Cropped_TSAL.jpg\" alt=\"TSAL\" title=\"TSAL\"\u003e\u003c/p\u003e\n\u003ch1 id=\"schematics---rev-d\"\u003eSchematics - Rev D\u003c/h1\u003e\n\u003ch2 id=\"tsal-control\"\u003eTSAL Control\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/images/tsal/TSAL_Control.png\" alt=\"TSAL Control\" title=\"TSAL Control\"\u003e\u003c/p\u003e\n\u003ch2 id=\"led-driver\"\u003eLED Driver\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/images/tsal/TSAL_LEDDriver.png\" alt=\"TSAL LED Driver\" title=\"TSAL LED Driver\"\u003e\u003c/p\u003e\n","description":null,"image":null,"permalink":"https://johnthatfield.github.io/projects/tsal/","title":"Tractive System Active Light (TSAL)"},{"content":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eThe vehicle control unit makes all of the decisions in the car. It reads the pedals, the brake pressure, the driver inputs and any other analog or resistive sensor in the vheicle. It receives an abundance of data over the CANbus about performance and temperatures of other vehicle aspects. It runs the traction control algorithms. It’s responsible for the control and power of the brake lights, pumps and cooling fans. And ultimately, it’s responsible for sending the motor torque requests over CAN to drive the vehicle.\u003c/p\u003e\n\u003cp\u003eFor now, check out my blog post on the VCU at \u003ca href=\"https://johnhatfield.substack.com/p/electric-vehicle-control-unit\" target=\"_blank\"\u003eSubstack\u003c/a\u003e\u003c/p\u003e\n\u003c!-- ![Scope Close Up](/images/inverter/measurement_close.jpg \"Scope Close Up\") --\u003e","description":null,"image":null,"permalink":"https://johnthatfield.github.io/projects/vcu/","title":"Vehicle Control Unit (VCU)"}]